<CascadingValue Value="this">
    @ChildContent
</CascadingValue>

@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    private List<EventCallback<StatePropertyChangedArgs>> Callbacks
    = new List<EventCallback<StatePropertyChangedArgs>>();

    // Each component will register a callback
    public void RegisterCallback(EventCallback<StatePropertyChangedArgs> callback)
    {
        // Only add if we have not already registered this callback
        if (!Callbacks.Contains(callback))
        {
            Callbacks.Add(callback);
        }
    }

    private void NotifyPropertyChanged(StatePropertyChangedArgs args)
    {
        foreach (var callback in Callbacks)
        {
            // Ignore exceptions due to dangling references
            try
            {
                // Invoke the callback
                callback.InvokeAsync(args);
            }
            catch { }
        }
    }

    #region Hero Related

    public string HeroName
    {
        get => field;
        set
        {
            field = value;
            StateHasChanged();
        }
    } = string.Empty;

    #endregion

    #region Player Info

    public string LeftPlayerName
    {
        get => field;
        set { field = value; StateHasChanged(); }
    } = string.Empty;

    public string LeftPlayerPronouns
    {
        get => field;
        set { field = value; StateHasChanged(); }
    } = string.Empty;

    public string RightPlayerName
    {
        get => field;
        set { field = value; StateHasChanged(); }
    } = string.Empty;

    public string RightPlayerPronouns
    {
        get => field;
        set { field = value; StateHasChanged(); }
    } = string.Empty;

    #endregion

    #region Objectives

    public string ObjectiveOne
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveOne), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveTwo
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveTwo), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveThree
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveThree), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveFour
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveFour), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveFive
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveFive), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveSix
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveSix), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveSeven
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveSeven), value));
            StateHasChanged();
        }
    } = string.Empty;

    public string ObjectiveEight
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(ObjectiveEight), value));
            StateHasChanged();
        }
    } = string.Empty;

    #endregion

    public bool HideTracker
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(HideTracker), value));
            StateHasChanged();
        }
    }

    public string BackgroundClass
    {
        get => field;
        set
        {
            field = value;
            NotifyPropertyChanged(new(nameof(BackgroundClass), value));
            StateHasChanged();
        }
    } = string.Empty;
}